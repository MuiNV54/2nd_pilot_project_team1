<% if @user.cover? %>
  <div class="cover">
    <%= image_tag @user.cover, id: "cover" %>
  </div>
<% else %>
  <div id="no_cover">
    <%= image_tag "", id: "cover" %>
  </div>
<% end %>
<% if @user.avatar? %>
  <div class="avatar">
    <%= image_tag @user.avatar, id: "avatar" %>
  </div>
<% else %>
  <%= image_tag "https://fbcdn-profile-a.akamaihd.net/hprofile-ak-frc1/c178.0.604.604/s160x160/252231_1002029915278_1941483569_n.jpg", id: "avatar" %>
<% end %>
<% if current_user? @user %>
  <%= form_for current_user, :html => { :multipart => true } do |f| %>
    <%= f.file_field :avatar, id: "btn_change_avatar" %>
    <%= f.file_field :cover, id: "btn_change_cover" %>
  <% end %>
<% end %>
<script>
  $(function(){
    $("#btn_change_avatar").change(function(){
      if (this.files && this.files[0]){
        var reader = new FileReader();
        reader.onload = function(e) {
          $("#avatar")
            .attr('src', e.target.result)
            .width(160)
            .height(160);
          };
        reader.readAsDataURL(this.files[0]);
        $(".edit_user").submit();
      }
    });
    $("#btn_change_cover").change(function(){
      if (this.files && this.files[0]){
        var reader = new FileReader();
        reader.onload = function(e) {
          $("#cover")
            .attr('src', e.target.result)
            .width(600)
            .height(160);
          };
        reader.readAsDataURL(this.files[0]);
        $(".edit_user").submit();
      }
    });
  });
</script>